{% extends "standard-form.njk" %}

{% from "radios/macro.njk" import govukRadios %}
{% set title = 'Choose ' + data.pronoun + ' address' %}

{% set errorMap = {
        'address': {
            'any.required': { ref: '#address', text: 'Choose an address' }
        }
    }
%}

{% set addressItems = [] %}

{% for address in data.addresses %}
    {{ addressItems.push({
        text: address.address,
        id: address.id,
        value: address.id,
        checked: payload['address'] === address.id
    }) }}
{% endfor %}

{% block pageContent %}
    <p class="govuk-body-m">
        {{ data.addresses.length }} {{ "address" if data.addresses.length === 1 else "addresses"}} found for 
        {{ data.searchTerms.premises}} and {{ data.searchTerms.postcode}}&nbsp;&nbsp;
        <a href="{{ data.lookupPage }}">
            Change<span class="govuk-visually-hidden"> address</span>
        </a>
    </p>

    {{ govukRadios({
        idPrefix: "address",
        name: "address",
        items: addressItems,
        errorMessage: { text: 'Choose an address' } if error
    })
    }}

    <p class="govuk-body-m">
        <a class="govuk-link" href="{{ data.entryPage }}">Enter the address manually</a>
    </p>
{% endblock %}
