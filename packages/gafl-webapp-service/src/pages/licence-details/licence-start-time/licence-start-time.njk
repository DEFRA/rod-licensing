{% extends "layout.njk" %}
{% from "radios/macro.njk" import govukRadios %}
{% from "fieldset/macro.njk" import govukFieldset %}
{% from "button/macro.njk" import govukButton %}
{% from "error-summary.njk" import errorSummary %}
{% from "back-link/macro.njk" import govukBackLink %}

{% set title = 'Choose when you would like the licence to start on ' + data.startDateStr %}

{% block pageTitle %}{{ title }} - GOV.UK{% endblock %}

{%
    set errorMap = {
        'licence-start-time': {
            'any.required': { ref: '#licence-start-time-am', text: 'Choose the time for the licence to start on ' + data.startDateStr }
        }
    }
%}

{% set am = [
    { text: "0am (first minute of the day)", value: "0", checked: payload['licence-start-time'] === '0', disabled: true if data.minHour > 0 else false },
    { text: "1am", value: "1", checked: payload['licence-start-time'] === '1', disabled: true if data.minHour > 1 else false },
    { text: "2am", value: "2", checked: payload['licence-start-time'] === '2', disabled: true if data.minHour > 2 else false },
    { text: "3am", value: "3", checked: payload['licence-start-time'] === '3', disabled: true if data.minHour > 3 else false },
    { text: "4am", value: "4", checked: payload['licence-start-time'] === '4', disabled: true if data.minHour > 4 else false },
    { text: "5am", value: "5", checked: payload['licence-start-time'] === '5', disabled: true if data.minHour > 5 else false },
    { text: "6am", value: "6", checked: payload['licence-start-time'] === '6', disabled: true if data.minHour > 6 else false },
    { text: "7am", value: "7", checked: payload['licence-start-time'] === '7', disabled: true if data.minHour > 7 else false },
    { text: "8am", value: "8", checked: payload['licence-start-time'] === '8', disabled: true if data.minHour > 8 else false },
    { text: "9am", value: "9", checked: payload['licence-start-time'] === '9', disabled: true if data.minHour > 9 else false },
    { text: "10am", value: "10", checked: payload['licence-start-time'] === '10', disabled: true if data.minHour > 10 else false },
    { text: "11am", value: "11", checked: payload['licence-start-time'] === '11', disabled: true if data.minHour > 11 else false }
] %}

{% set pm = [
    { text: "12pm (midday)", value: "12", checked: payload['licence-start-time'] === '12', disabled: true if data.minHour > 12 else false },
    { text: "1pm", value: "13", checked: payload['licence-start-time'] === '13', disabled: true if data.minHour > 13 else false },
    { text: "2pm", value: "14", checked: payload['licence-start-time'] === '14', disabled: true if data.minHour > 14 else false },
    { text: "3pm", value: "15", checked: payload['licence-start-time'] === '15', disabled: true if data.minHour > 15 else false },
    { text: "4pm", value: "16", checked: payload['licence-start-time'] === '16', disabled: true if data.minHour > 16 else false },
    { text: "5pm", value: "17", checked: payload['licence-start-time'] === '17', disabled: true if data.minHour > 17 else false },
    { text: "6pm", value: "18", checked: payload['licence-start-time'] === '18', disabled: true if data.minHour > 18 else false },
    { text: "7pm", value: "19", checked: payload['licence-start-time'] === '19', disabled: true if data.minHour > 19 else false },
    { text: "8pm", value: "20", checked: payload['licence-start-time'] === '20', disabled: true if data.minHour > 20 else false },
    { text: "9pm", value: "21", checked: payload['licence-start-time'] === '21', disabled: true if data.minHour > 21 else false },
    { text: "10pm", value: "22", checked: payload['licence-start-time'] === '22', disabled: true if data.minHour > 22 else false },
    { text: "11pm", value: "23", checked: payload['licence-start-time'] === '23', disabled: true if data.minHour > 23 else false }
] %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            {% if backRef %}
                {{ govukBackLink({
                    text: "Back",
                    href: backRef,
                    classes: "govuk-!-margin-bottom-7"
                }) }}
            {% endif %}
            {{ errorSummary(error, errorMap) }}
            {% call govukFieldset({
                legend: {
                    text: title,
                    classes: "govuk-fieldset__legend--l govuk-!-margin-bottom-3",
                    isPageHeading: true
                }
            }) %}
        </div>
        <div class="govuk-grid-column-full">
            <form method="post" novalidate>
                <div class="govuk-grid-row">
                    <div class="govuk-grid-column-one-half">
                        {{ govukRadios({
                            idPrefix: "licence-start-time-am",
                            name: "licence-start-time",
                            items: am,
                            errorMessage: { text: 'Choose the time for the licence to start' } if error
                        }) }}
                    </div>

                    <div class="govuk-grid-column-one-half">
                        {{ govukRadios({
                            idPrefix: "licence-start-time-pm",
                            name: "licence-start-time",
                            items: pm
                        }) }}
                    </div>
                </div>

                {% endcall %}

                {{ govukButton({
                    attributes: { id: 'continue' },
                    preventDoubleClick: true,
                    name: "continue",
                    text: "Continue",
                    classes: "govuk-!-margin-top-5"
                }) }}
                {{ csrf() }}
            </form>
        </div>
    </div>

{% endblock %}