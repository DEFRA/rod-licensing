{% extends "layout.njk" %}


{% from "accordion.njk" import accordion %}
{% from "back-link/macro.njk" import govukBackLink %}
{% from "fieldset/macro.njk" import govukFieldset %}
{% from "button/macro.njk" import govukButton %}
{% from "checkboxes/macro.njk" import govukCheckboxes %}
{% from "error-summary.njk" import errorSummary %}
{% from "back-link/macro.njk" import govukBackLink %}
{% from "warning-text/macro.njk" import govukWarningText %}

{% set title = mssgs.terms_conds_title %}
{% block pageTitle %}{{ title }}{{ mssgs.gov_uk }}{% endblock %}

{%
    set errorMap = {
        'agree': {
            'any.required': { ref: '#agree', text: mssgs.terms_conds_error }
        }
    }
%}

{% block content %}
    {% if backRef %}
        {{ govukBackLink({
            text: mssgs.back,
            href: backRef,
            classes: "govuk-!-margin-bottom-7"
        }) }}
    {% endif %}

    {{ errorSummary(error, errorMap, mssgs.there_is_a_problem) }}

    <form method="post">

        {{ govukFieldset({
            legend: {
                text: title,
                classes: "govuk-fieldset__legend--l govuk-!-margin-bottom-3",
                isPageHeading: true
            }
        }) }}

        {% if data.paymentRequired %}
            {{ govukWarningText({
                text: mssgs.terms_conds_warning,
                iconFallbackText: "Warning"
            }) }}
        {% endif %}
        
        {{ accordion(mssgs, troutAndCoarse2Rods, troutAndCoarse3Rods, salmonAndSeaTrout)}}

        <h2 class="govuk-heading-m">{{ mssgs.licence_conditions_byelaws_title }}</h2>
        <p class="govuk-body">{{ mssgs.licence_conditions_byelaws }}</p>

        <h2 class="govuk-heading-m">{{ mssgs.licence_conditions_privacy_policy_title }}</h2>
        <p class="govuk-body">{{ mssgs.licence_conditions_privacy_policy }}</p>

        <h2 class="govuk-heading-m">{{ mssgs.licence_conditions_incident_title }}</h2>
        <p class="govuk-body">{{ mssgs.licence_conditions_incident }}</p>

        {{ govukCheckboxes({
            idPrefix: "agree",
            name: "agree",
            errorMessage: { text: mssgs.terms_conds_error_must_agree } if error,
            items: [
            {
                value: "yes",
                text: mssgs.terms_conds_item_agree
            }
            ]
        }) }}

        {{ govukButton({
            attributes: { id: 'continue' },
            preventDoubleClick: true,
            name: "continue",
            text: mssgs.terms_conds_pay_button_1 if data.paymentRequired else mssgs.terms_conds_pay_button_2,
            classes: "govuk-!-margin-top-5"
        }) }}

        <div class="govuk-body-m"><a class="govuk-link" href="https://www.gov.uk/fishing-licences/buy-a-fishing-licence">{{ mssgs.terms_conds_pay_on_gov_uk }}</a></div>

        {{ csrf() }}
    </form> 
{% endblock %}
