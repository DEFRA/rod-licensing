{% extends "layout.njk" %}

{% from "button/macro.njk" import govukButton %}
{% from "summary-list/macro.njk" import govukSummaryList %}
{% from "warning-text/macro.njk" import govukWarningText %}

{% set title = mssgs.multibuy_view_licences_title %}
{% block pageTitle %}{{ title }}{{ mssgs.gov_uk }}{% endblock %}

{% block content %}

{% if data.licencesRemaining === true %}
  <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">

          <h1 class="govuk-heading-l"> {{ mssgs.multibuy_view_licences_heading }} </h1>

          {% if data.duplicate === true %}
            {{ govukWarningText({
              text: mssgs.multibuy_licences_warning_duplicate,
              iconFallbackText: "Warning"
            }) }}
          {% endif %}

            {% for licence in data.licences %}

                {% set licenceInfo = [
                  { key: { text: mssgs.licence_summary_licence_holder }, value: { text: licence.licenceHolder } }, 
                  { key: { text: mssgs.licence_summary_type }, value: { text: licence.type } }, 
                  { key: { text: mssgs.licence_summary_length }, value: { text: licence.length } }, 
                  { key: { text: mssgs.licence_summary_start }, value: { text: licence.start } }, 
                  { key: { text: mssgs.licence_summary_price }, value: { text: mssgs.pound + licence.price } }
                  ]
                %}

                  {{ govukSummaryList({
                    rows: licenceInfo
                  }) }}

                  {{ govukButton({
                    text: mssgs.contact_summary_change,
                    href: "/buy/set-current-permission?permissionIndex=" + licence.index,
                    attributes: { 'aria-label': "Change licence" },
                    classes: "govuk-button--secondary"
                  })}}

                  {{ govukButton({
                    text: mssgs.remove,
                    href: "/buy/remove-licence?permissionIndex=" + licence.index,
                    classes: "govuk-button--secondary"
                  })}}

              {% endfor %}
      </div>
  </div>

  <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
              {{ govukButton({
                  text: mssgs.continue,
                  href: data.uri.add_licence
              })}}
      </div>
  </div>
{% else %}
  <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-l"> {{ mssgs.multibuy_view_licences_heading }} </h1>
        <p class="govuk-body">{{ mssgs.multibuy_no_licences }}</p>
      </div>
  </div>

  <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        {{ govukButton({
            text: mssgs.add_a_licence,
            href: data.uri.new
        })}}
      </div>
  </div>
{% endif %}

{% endblock %}
